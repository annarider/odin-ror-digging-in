<h1>Post Updates</h1>

<%= link_to "Create New Post", new_post_path %>

<div class="posts">
  <% @posts.each do |post| %>
    <div class="post">
      <div class="post-header">
        <%= link_to user_path(post.user) do %>
          <%= image_tag post.user.profile_picture_url(size: 50), alt: "#{post.user.name}'s profile picture", class: "profile-picture" %>
        <% end %>
        <h2><%= link_to post.user.name, user_path(post.user) %></h2>
      </div>

      <p><%= post.content %></p>

      <% if post.image %>
        <%= image_tag post.image %>
      <% end %>

      <p><small>Posted <%= time_ago_in_words(post.created_at) %> ago</small></p>

      <!-- Post Engagement Stats -->
      <div class="post-stats">
        <span>
          <strong><%= post.likes.count %></strong> <%= "like".pluralize(post.likes.count) %>
        </span>
        <span>
          <strong><%= post.comments.count %></strong> <%= "comment".pluralize(post.comments.count) %>
        </span>
      </div>

      <!-- Quick Actions -->
      <div class="post-actions">
        <% if post.likes.exists?(user: current_user) %>
          <% user_like = post.likes.find_by(user: current_user) %>
          <%= button_to "Unlike", like_path(user_like), method: :delete %>
        <% else %>
          <%= button_to "Like", post_likes_path(post), method: :post %>
        <% end %>

        <%= link_to "View Post & Comments", post_path(post) %>
      </div>
    </div>
  <% end %>
</div>
